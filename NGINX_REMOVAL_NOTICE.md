# Nginx to Apache Migration Notice

## Summary

As of this release, **Nginx support has been completely removed** from RaOS/RaCore. 

**Important Architectural Clarification:**
- **RaOS uses an internal Kestrel webserver** (ASP.NET) on port 80 for API endpoints and control panel
- **On Windows 11**: Kestrel is the ONLY supported webserver - no external webserver is needed
- **On Linux**: External Apache/PHP8 is optional - only needed if you want to execute PHP files generated by RaOS (CMS, forums, profiles)
- RaOS does NOT manage external webservers - it only detects if PHP8 is available for executing generated files
- Website files are spawned to Admin folders, not hosted inside RaOS mainframe

## What Changed

### Removed Components
- `RaCore/Engine/NginxManager.cs` - Nginx configuration manager
- `RaCore/Tests/NginxManagerPhpPathTests.cs` - Nginx-related tests
- `RaCore/Nginx/` - Nginx configuration directory
- `RaCore/nginx_conf/` - Nginx configuration templates
- `setup/setup-nginx-permissions.sh` - Nginx permissions setup script
- `setup/ubuntu-nginx-sudoers` - Nginx sudoers configuration
- All Nginx-related API endpoints in Program.cs
- `IServerSetupModule.SetupNginxConfigAsync()` method

### Added/Enhanced Components
- **PHP8 Detection**: Added detection for external PHP8 runtime
  - `PhpDetector` class detects PHP8 installation
  - Required only if you want to execute generated PHP files (CMS, forums, profiles)
  - Requires PHP8 development ini defaults
  
- **FTP Integration**: Added FTP client support for spawning configs to Admin folders
  - `FtpHelper` class for file operations using configured credentials
  - ServerConfiguration now includes FTP credentials (FtpUsername, FtpPassword, FtpHost, FtpPort)
  - Used for spawning multi-website reseller configs externally

- **Internal Kestrel Webserver**: RaOS uses internal ASP.NET Kestrel webserver
  - Runs on port 80 by default (or custom port for games)
  - Serves API endpoints and control panel
  - Does NOT host website files (those go to Admin folders)

## Migration Guide

### For Developers

If you have code that references Nginx components:

1. **Remove Nginx References**: Delete any code that calls `NginxManager` or `SetupNginxConfigAsync`
2. **Understand the Architecture**: 
   - RaOS uses internal Kestrel webserver (port 80) for APIs
   - External Apache/PHP8 is optional, only for executing generated PHP files
   - Website files spawn to Admin folders, not mainframe

### For System Administrators

**Windows 11:**
- No external webserver needed - Kestrel handles everything
- Apache/Nginx are NOT supported or required
- CMS creation works out of the box with Kestrel

**Linux:**
1. **Uninstall Nginx** (optional): If you were using Nginx solely for RaOS, you can remove it
2. **Install PHP8** (optional): Only needed if you want to execute PHP files generated by RaOS:
   - Install PHP 8.x with development ini defaults
   - Configure to execute PHP files in Admin folders
3. **Update FTP Settings**: Add FTP credentials to your `server-config.json`:
   ```json
   {
     "FtpUsername": "your-ftp-username",
     "FtpPassword": "your-ftp-password",
     "FtpHost": "localhost",
     "FtpPort": 21
   }
   ```

### RaOS Architecture

**Windows 11:**
- **Internal Webserver**: Kestrel (ASP.NET) on port 80 for everything (API, control panel, CMS)
- **No External Webserver**: Apache/Nginx/PHP are NOT needed or supported
- **FTP**: Optional, only for external file management

**Linux:**
- **Internal Webserver**: Kestrel (ASP.NET) on port 80 for API/control panel
- **Generated Files**: PHP files spawned to Admin folders for multi-website reseller hosting
- **External PHP8**: Optional, only for executing generated PHP files
- **FTP Client**: Used to spawn configs and files to external locations

## Why This Change?

- **Simplified Architecture**: RaOS uses internal Kestrel webserver, no external webserver management needed
- **Reseller Model**: Multi-website configs are spawned externally to Admin folders via FTP
- **Optional PHP**: External PHP8 only needed if you want to execute generated PHP files
- **Single Port**: RaCore uses port 80 by default (games can create custom ports)

## Need Help?

If you encounter issues:

1. Check that PHP8 is installed: `php -v` (optional, only if using generated PHP files)
2. Ensure RaOS is running on port 80: Check `server-config.json`
3. Verify FTP credentials are configured if spawning files externally
4. Check the RaOS logs for any warnings

## Documentation Updates

The following documentation files contain historical Nginx references but are kept for archival purposes:

- `docs/archive/summaries/BOOT_SEQUENCE.md`
- `docs/archive/summaries/NGINX_MIGRATION_SUMMARY.md`
- `docs/archive/migrations/NGINX_MIGRATION_GUIDE.md`
- Various files in `docs/archive/`

Current documentation reflects that RaOS uses an internal Kestrel webserver and optionally detects external PHP8.

---

**Last Updated**: 2025-01-08  
**RaCore Version**: 1.0+  
**Migration Status**: Complete  
**Architecture**: Internal Kestrel webserver with optional external PHP8 for generated files
